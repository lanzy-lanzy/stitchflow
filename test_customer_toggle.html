<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Customer Toggle</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-xl shadow-lg p-8">
            <h1 class="text-2xl font-bold text-gray-800 mb-6">Test Customer Toggle Functionality</h1>
            
            <!-- Customer Selection/Creation Section -->
            <div class="md:col-span-2">
                <div class="bg-white border border-gray-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-4">
                        <label class="block text-sm font-medium text-gray-700">Customer *</label>
                        <div class="flex bg-gray-100 rounded-lg p-1">
                            <button type="button" id="existingCustomerTab" 
                                class="px-3 py-1 text-sm font-medium rounded-md bg-white text-gray-900 shadow-sm">
                                Select Existing
                            </button>
                            <button type="button" id="newCustomerTab" 
                                class="px-3 py-1 text-sm font-medium rounded-md text-gray-500 hover:text-gray-900">
                                Create New
                            </button>
                        </div>
                    </div>
                    
                    <!-- Existing Customer Selection -->
                    <div id="existingCustomerSection">
                        <select id="customer" name="customer" required
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            <option value="">Select a customer</option>
                            <option value="1">John Doe (customer_123)</option>
                            <option value="2">Jane Smith (customer_456)</option>
                        </select>
                    </div>
                    
                    <!-- New Customer Creation Form -->
                    <div id="newCustomerSection" class="hidden">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="new_first_name" class="block text-sm font-medium text-gray-700 mb-1">First Name *</label>
                                <input type="text" id="new_first_name" name="new_first_name"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                            <div>
                                <label for="new_last_name" class="block text-sm font-medium text-gray-700 mb-1">Last Name *</label>
                                <input type="text" id="new_last_name" name="new_last_name"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                            <div>
                                <label for="new_email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                <input type="email" id="new_email" name="new_email"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                            <div>
                                <label for="new_phone_number" class="block text-sm font-medium text-gray-700 mb-1">Phone Number *</label>
                                <input type="tel" id="new_phone_number" name="new_phone_number"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                            <div class="md:col-span-2">
                                <label for="new_address" class="block text-sm font-medium text-gray-700 mb-1">Address *</label>
                                <textarea id="new_address" name="new_address" rows="2"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-6">
                <button type="button" onclick="testValidation()" 
                    class="px-6 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700">
                    Test Validation
                </button>
            </div>
            
            <div id="testResults" class="mt-4 p-4 bg-gray-50 rounded-lg hidden">
                <h3 class="font-semibold text-gray-800 mb-2">Test Results:</h3>
                <div id="resultContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Initialize customer section tabs
        function initializeCustomerTabs() {
            const existingTab = document.getElementById('existingCustomerTab');
            const newTab = document.getElementById('newCustomerTab');
            const existingSection = document.getElementById('existingCustomerSection');
            const newSection = document.getElementById('newCustomerSection');
            const customerSelect = document.getElementById('customer');

            // Check if all required elements exist
            if (!existingTab || !newTab || !existingSection || !newSection || !customerSelect) {
                console.error('Customer tab elements not found. Tab functionality will not work.');
                return;
            }

            // Tab click handlers
            existingTab.addEventListener('click', function() {
                // Switch to existing customer tab
                existingTab.classList.add('bg-white', 'text-gray-900', 'shadow-sm');
                existingTab.classList.remove('text-gray-500');
                newTab.classList.remove('bg-white', 'text-gray-900', 'shadow-sm');
                newTab.classList.add('text-gray-500');
                
                // Show/hide sections
                existingSection.classList.remove('hidden');
                newSection.classList.add('hidden');
                
                // Update form validation
                customerSelect.required = true;
                clearNewCustomerFields();
                setNewCustomerFieldsRequired(false);
            });

            newTab.addEventListener('click', function() {
                // Switch to new customer tab
                newTab.classList.add('bg-white', 'text-gray-900', 'shadow-sm');
                newTab.classList.remove('text-gray-500');
                existingTab.classList.remove('bg-white', 'text-gray-900', 'shadow-sm');
                existingTab.classList.add('text-gray-500');
                
                // Show/hide sections
                newSection.classList.remove('hidden');
                existingSection.classList.add('hidden');
                
                // Update form validation
                customerSelect.required = false;
                customerSelect.value = '';
                setNewCustomerFieldsRequired(true);
            });
        }

        // Helper function to clear new customer fields
        function clearNewCustomerFields() {
            document.getElementById('new_first_name').value = '';
            document.getElementById('new_last_name').value = '';
            document.getElementById('new_email').value = '';
            document.getElementById('new_phone_number').value = '';
            document.getElementById('new_address').value = '';
        }

        // Helper function to set required attribute on new customer fields
        function setNewCustomerFieldsRequired(required) {
            const requiredFields = ['new_first_name', 'new_last_name', 'new_phone_number', 'new_address'];
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (required) {
                    field.setAttribute('required', 'required');
                } else {
                    field.removeAttribute('required');
                }
            });
        }

        function testValidation() {
            const isNewCustomer = !document.getElementById('newCustomerSection').classList.contains('hidden');
            const results = document.getElementById('resultContent');
            
            let resultHtml = `<p><strong>Current Mode:</strong> ${isNewCustomer ? 'Create New Customer' : 'Select Existing Customer'}</p>`;
            
            if (isNewCustomer) {
                const firstName = document.getElementById('new_first_name').value;
                const lastName = document.getElementById('new_last_name').value;
                const phone = document.getElementById('new_phone_number').value;
                const address = document.getElementById('new_address').value;
                
                resultHtml += `<p><strong>New Customer Data:</strong></p>`;
                resultHtml += `<ul class="list-disc list-inside ml-4">`;
                resultHtml += `<li>First Name: ${firstName || '(empty)'}</li>`;
                resultHtml += `<li>Last Name: ${lastName || '(empty)'}</li>`;
                resultHtml += `<li>Phone: ${phone || '(empty)'}</li>`;
                resultHtml += `<li>Address: ${address || '(empty)'}</li>`;
                resultHtml += `</ul>`;
            } else {
                const selectedCustomer = document.getElementById('customer').value;
                resultHtml += `<p><strong>Selected Customer ID:</strong> ${selectedCustomer || '(none selected)'}</p>`;
            }
            
            results.innerHTML = resultHtml;
            document.getElementById('testResults').classList.remove('hidden');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeCustomerTabs();
        });
    </script>
</body>
</html>
